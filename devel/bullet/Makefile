# Created by: Jose Alonso Cardenas Marquez <acm@FreeBSD.org>

PORTNAME=	bullet
PORTVERSION=	3.21
CATEGORIES=	devel

MAINTAINER=	fluffy@FreeBSD.org
COMMENT=	3D collision detection and rigid body dynamics library

LICENSE=	ZLIB
LICENSE_FILE=	${WRKSRC}/LICENSE.txt

USES=		cmake compiler:c++11-lang gl xorg
USE_GL=		gl glu glut
USE_LDCONFIG=	yes
USE_XORG=	x11

USE_GITHUB=	yes
GH_ACCOUNT=	bulletphysics
GH_PROJECT=	bullet3

CMAKE_ARGS=	-DBUILD_SHARED_LIBS:BOOL=ON \
		-DINSTALL_LIBS:BOOL=ON \
		-DINSTALL_EXTRA_LIBS:BOOL=ON \
		-DBUILD_EXTRAS:BOOL=OFF \
		-DUSE_DOUBLE_PRECISION:BOOL=ON \
		-DUSE_GRAPHICAL_BENCHMARK:BOOL=OFF \
		-DENABLE_VHACD:BOOL=OFF \
		-DBUILD_BULLET3:BOOL=ON \
		-DBUILD_CPU_DEMOS:BOOL=OFF \
		-DBUILD_BULLET2_DEMOS:BOOL=OFF \
		-DBUILD_BULLET3_DEMOS:BOOL=OFF \
		-DBUILD_PYBULLET:BOOL=OFF \
		-DBUILD_OPENGL3_DEMOS:BOOL=OFF \
		-DBUILD_BULLET_ROBOTICS_GUI_EXTRA:BOOL=OFF \
		-DBUILD_UNIT_TESTS:BOOL=OFF \
		-DBULLET2_MULTITHREADING:BOOL=ON \
		-DBULLET2_USE_OPEN_MP_MULTITHREADING:BOOL=ON
#		-DBULLET2_USE_TBB_MULTITHREADING:BOOL=ON

PORTDOCS=	*

OPTIONS_DEFINE=	DOCS

PLIST_SUB=	LIB_VERSION=3.20

post-patch:
	@${REINPLACE_CMD} \
	-e '/pybullet/d' \
	${WRKSRC}/MANIFEST.in
	@${RM} -r ${WRKSRC}/examples/pybullet

post-install-DOCS-on:
	@${MKDIR} ${STAGEDIR}/${DOCSDIR}
	${INSTALL_DATA} ${WRKSRC}/docs/*.pdf ${STAGEDIR}/${DOCSDIR}

.include <bsd.port.mk>

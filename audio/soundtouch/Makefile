# Created by: Alexey Dokuchaev <danfe@FreeBSD.org>

PORTNAME=	soundtouch
DISTVERSION=	2.3.1
CATEGORIES=	audio

MAINTAINER=	crees@FreeBSD.org
COMMENT=	Open-source audio processing library

LICENSE=	LGPL21
LICENSE_FILE=	${WRKSRC}/COPYING.TXT

USES=		cmake cpe
USE_GITLAB=	yes
GL_COMMIT=	e1f315f5358d9db5cee35a7a2886425489fcefe8
USE_LDCONFIG=	yes

CPE_VENDOR=	surina

CMAKE_ON=	BUILD_SHARED_LIBS

OPTIONS_DEFINE=		INTEGER_SAMPLES OPTIMIZED_CFLAGS
OPTIONS_DEFINE_aarch64=	NEON OPENMP
OPTIONS_DEFINE_amd64=	OPENMP
OPTIONS_DEFINE_armv7=	NEON
OPTIONS_DEFAULT=	${MACHINE_CPU:Msoftfp:C/.+/INTEGER_SAMPLES/}
OPTIONS_DEFAULT_aarch64=NEON OPENMP OPTIMIZED_CFLAGS
OPTIONS_DEFAULT_amd64=	OPENMP OPTIMIZED_CFLAGS

INTEGER_SAMPLES_DESC=	Use integer sample format
NEON_DESC=		Use NEON instructions

INTEGER_SAMPLES_CMAKE_BOOL=	INTEGER_SAMPLES
NEON_CMAKE_BOOL=		NEON
OPENMP_CMAKE_BOOL=		OPENMP
OPTIMIZED_CFLAGS_CFLAGS=	-Ofast

.include <bsd.port.mk>
